This README file contains information on the contents of the
meta-barcode-poc layer.

To build the full barcode POC, access to application layer is needed.
Please contact dirk.seidel.uj@renesas.com or abigail.sun.xh@renesas.com for access

Please see the corresponding sections below for details.

Dependencies
============

  URI: git://git.yoctoproject.org/poky  
  Layers: meta, meta-poky, meta-yocto-bsp  
  Branch: dunfell  
  Revision: e32d854e33bc86c2a616df8708e021a098afcf73  
  (Tag: dunfell-23.0.5)  
  (Need to cherry-pick a commit: git cherry-pick 9e444)

  URI: git://git.openembedded.org/meta-openembedded  
  Layers: meta-oe, meta-python, meta-multimedia  
  Branch: dunfell  
  Revision: cc6fc6b1641ab23089c1e3bba11e0c6394f0867c

  URI: https://git.yoctoproject.org/meta-gplv2  
  Layers: meta-gplv2  
  Branch: dunfell  
  Revision: 60b251c25ba87e946a0ca4cdc8d17b1cb09292ac

  URI: ssh://git@github.com/meta-qt5/meta-qt5  
  Layers: meta-qt5  
  Revision: c1b0c9f546289b1592d7a895640de103723a0305

  URI: https://github.com/renesas-rz/meta-rzg2.git  
  Layers: meta-rzg2  
  Tag: rzg2l\_bsp\_v1.3  
  Fixes: Apply (git am) the patches found in patches/meta-rzg2 from this repo

This meta-layer also depends on *meta-rz-features* for the RZ/G2L BSP v1.3.
*meta-rz-features* can be downloaded from the Renesas website in two packages:
* [Mali Graphic Library](https://www.renesas.com/us/en/products/microcontrollers-microprocessors/rz-arm-based-high-end-32-64-bit-mpus/rzg2l-mali-graphic-library-evaluation-version)
* [Video Codec Library](https://www.renesas.com/us/en/products/microcontrollers-microprocessors/rz-arm-based-high-end-32-64-bit-mpus/rzg2l-video-codec-library-evaluation-version-v053)

BSP Support
===========

The Barcode PoC specific BSP additions are included within this repo and can
be found under directory **recipes-kernel/linux/linux-renesas/patches/**.
The additions are in the form of patches to apply on top of the official
Linux kernel for RZ/G2L.

The repository hosting the official Linux kernel version for RZ/G2L can be found
cloned from:
```
git://github.com/renesas-rz/rz_linux-cip.git
```
The commit this BSP is based on is c819d510b2b02511f083023bcd8d6cd41f9d003c.
On top of that commit, meta-rzg2 adds a number of patches (found under
**meta-rzg2/recipes-kernel/linux/linux-renesas/patches/main/**), and top of those
patches this meta-layer add a few more patches from
**recipes-kernel/linux/linux-renesas/patches/**.

The Linux kernel configuration used by this project is based on the defconfig
file found in the **rz\_linux-cip.git** repository. On top of that, this repo
applies a configuration fragment (from file
**recipes-kernel/linux/linux-renesas/barcode-poc.cfg**) to make the Kernel Image
suitable for the Barcode PoC.

Patches
=======

Please submit any patches against the meta-barcode-poc layer to
Fabrizio Castro \<fabrizio.castro.jz@renesas.com\>

Maintainer: Fabrizio Castro \<fabrizio.castro.jz@renesas.com\>

How to build the Barcode PoC image
==================================

After setting up the project directory with this repository and its
dependencies, run the below commands from the project directory:
```
source poky/oe-init-build-env
cp ../meta-barcode-poc/docs/templates/conf/barcode-poc-g2l/* conf
bitbake barcode-demo
```
When the Yocto build finishes, the artifacts generated will be found under the
deploy directory corresponding to the machine the system was built for
(**barcode-poc-g2l**):

*tmp/deploy/images/barcode-poc-g2l*

SD Generation (from a Linux machine)
====================================

The system can fully run off a micro SD card (at least 16GB in size).

Insert the micro SD card into your computer SD card reader.
Locate the block device corresponding to the micro SD card as seen by your
computer. This document will refer to the micro SD card device as */dev/sdcard*,
please replace it with the appropriate block device filepath when following the
instructions.

From a Linux terminal, cd into the deploy directory for **barcode-poc-g2l**
(please refer to the previous section for more details).
Locate the *wic* image from the deploy directory (it's a regular file with name
ending in **wic.gz**). In the below example we'll be using filename
*barcode-demo-barcode-poc-g2l-20211125164543.rootfs.wic.gz* for simplicity,
please replace it with the actual filename for generated by your build.

To copy to image onto the micro SD card, simply run the below commands (with
the SD card device filepath and wic image filename replaced with the names
appropriate for your system):

```
sudo umount /dev/sdcard*
sudo bmaptool copy --nobmap barcode-demo-barcode-poc-g2l-20211125164543.rootfs.wic.gz /dev/sdcard
```

*bmaptool* will take some time to complete.
